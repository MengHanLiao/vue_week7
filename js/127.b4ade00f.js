"use strict";(self["webpackChunkvue_week7"]=self["webpackChunkvue_week7"]||[]).push([[127],{9127:function(e,t,s){s.r(t),s.d(t,{default:function(){return he}});var l=s(3396),a=s(7139);const r={class:"container my-5"},o={class:"d-flex justify-content-between mb-3"},i=(0,l._)("h2",null,"訂單列表",-1),d={class:"tabel-responsive"},n={class:"table align-middle mb-4"},c=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"購買時間"),(0,l._)("th",null,"Email"),(0,l._)("th",null,"商品項目"),(0,l._)("th",null,"應付金額"),(0,l._)("th",null,"是否付款"),(0,l._)("th",{class:"text-end"},"操作")])],-1),u={key:0},p=(0,l._)("td",{colspan:"6"},"目前沒有訂單",-1),h=[p],m={class:"list-unstyled mb-0"},g={class:"form-check"},_=["id","checked","onChange"],b=["for"],w={key:0,class:"text-success"},v={key:1,class:"text-danger"},y={class:"text-end"},D={class:"btn-group",role:"group","aria-label":"Basic example"},f=["onClick"],k=["onClick"];function O(e,t,s,p,O,M){const z=(0,l.up)("PaginationComponent"),$=(0,l.up)("DeleteConfirm"),x=(0,l.up)("OrderModal");return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("div",o,[i,(0,l._)("button",{class:"btn btn-danger",type:"button",onClick:t[0]||(t[0]=e=>M.openDeleteModal(!0))},"刪除所有訂單")]),(0,l._)("div",d,[(0,l._)("table",n,[c,(0,l._)("tbody",null,[0===O.orders.length?((0,l.wg)(),(0,l.iD)("tr",u,h)):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(O.orders,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,(0,a.zw)(M.changeDate(e.create_at)),1),(0,l._)("td",null,(0,a.zw)(e.user.email),1),(0,l._)("td",null,[(0,l._)("ul",m,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.products,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e.id},(0,a.zw)(e.product.title)+" 數量："+(0,a.zw)(e.qty)+" "+(0,a.zw)(e.product.unit),1)))),128))])]),(0,l._)("td",null,(0,a.zw)(e.total),1),(0,l._)("td",null,[(0,l._)("div",g,[(0,l._)("input",{class:"form-check-input",type:"checkbox",id:`isPaidfor${e.id}`,checked:e.is_paid,onChange:t=>M.updateOrderPaid(e)},null,40,_),(0,l._)("label",{class:"form-check-label",for:`isPaidfor${e.id}`},[e.is_paid?((0,l.wg)(),(0,l.iD)("span",w,"已付款")):((0,l.wg)(),(0,l.iD)("span",v,"未付款"))],8,b)])]),(0,l._)("td",y,[(0,l._)("div",D,[(0,l._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t=>M.openOrderModal(e)}," 檢視 ",8,f),(0,l._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>M.openDeleteModal(!1,e)}," 刪除 ",8,k)])])])))),128))])]),(0,l.Wm)(z,{"page-data":O.pagination,onEmitPage:M.getOrders},null,8,["page-data","onEmitPage"])]),(0,l.Wm)($,{ref:"deleteModal","delete-item":O.tempOrder,onEmitDelete:M.deleteOrder},null,8,["delete-item","onEmitDelete"]),(0,l.Wm)(x,{ref:"orderModal",order:O.tempOrder,onEmitPage:M.getOrders},null,8,["order","onEmitPage"])])}var M=s(297);const z={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"orderModal","aria-hidden":"true",ref:"modal"},$={class:"modal-dialog modal-lg"},x={class:"modal-content"},C=(0,l._)("div",{class:"modal-header"},[(0,l._)("h4",{class:"modal-title"},"檢視訂單"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),P={class:"modal-body"},E={class:"row"},S={class:"col-6"},Z=(0,l._)("h5",null,"訂單資訊",-1),A={class:"list-group list-group-flush"},H={class:"list-group-item"},K={class:"list-group-item"},W={class:"list-group-item"},Y={class:"list-group-item"},j=(0,l.Uk)("付款狀態： "),q={key:0},B={key:1},L={class:"col-6"},N=(0,l._)("h5",null,"訂購人資訊",-1),T={class:"list-group list-group-flush"},U={class:"list-group-item"},F={class:"list-group-item"},G={class:"list-group-item"},I={class:"list-group-item"},J=(0,l._)("h5",{class:"text-center mt-3"},"訂購商品",-1),Q={class:"table table-borderless table-hover"},R=(0,l._)("thead",null,[(0,l._)("tr",{class:"border-bottom"},[(0,l._)("th",{scope:"col"},"名稱"),(0,l._)("th",{scope:"col"},"單價"),(0,l._)("th",{scope:"col"},"數量/單位"),(0,l._)("th",{scope:"col"},"單項總金額")])],-1),V={scope:"row"},X={class:"text-center"},ee=(0,l._)("h5",null,"留言",-1),te={key:0},se={key:1},le=(0,l._)("div",{class:"modal-footer"},[(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ")],-1);function ae(e,t,s,r,o,i){return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",z,[(0,l._)("div",$,[(0,l._)("div",x,[C,(0,l._)("div",P,[(0,l._)("div",E,[(0,l._)("div",S,[Z,(0,l._)("ul",A,[(0,l._)("li",H,"訂單編號： "+(0,a.zw)(s.order.id),1),(0,l._)("li",K,"訂單日期： "+(0,a.zw)(s.order.create_at),1),(0,l._)("li",W,"總金額： "+(0,a.zw)(s.order.total),1),(0,l._)("li",Y,[j,s.order.is_paid?((0,l.wg)(),(0,l.iD)("span",q,"已付款")):((0,l.wg)(),(0,l.iD)("span",B,"未付款"))])])]),(0,l._)("div",L,[N,(0,l._)("ul",T,[(0,l._)("li",U,"姓名： "+(0,a.zw)(s.order.user?.name),1),(0,l._)("li",F,"信箱： "+(0,a.zw)(s.order.user?.email),1),(0,l._)("li",G,"電話： "+(0,a.zw)(s.order.user?.tel),1),(0,l._)("li",I,"地址： "+(0,a.zw)(s.order.user?.address),1)])])]),J,(0,l._)("table",Q,[R,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.order.products,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("th",V,(0,a.zw)(e.product.title),1),(0,l._)("td",null,(0,a.zw)(e.product.price),1),(0,l._)("td",null,(0,a.zw)(e.qty)+" / "+(0,a.zw)(e.product.unit),1),(0,l._)("td",null,"NT$ "+(0,a.zw)(e.total),1)])))),128))])]),(0,l._)("div",X,[ee,s.order.message?((0,l.wg)(),(0,l.iD)("p",te,(0,a.zw)(s.order.message),1)):((0,l.wg)(),(0,l.iD)("p",se,"這筆訂單沒有留言喔~"))])]),le])])],512)])}var re=s(123),oe={mixins:[re.Z],props:{order:{type:Object,default(){return{}}}}},ie=s(89);const de=(0,ie.Z)(oe,[["render",ae]]);var ne=de,ce=s(9314),ue={data(){return{orders:[],pagination:{},tempOrder:{},isDeleteAll:!1}},components:{PaginationComponent:M.Z,OrderModal:ne,DeleteConfirm:ce.Z},methods:{getOrders(e=1){const t=this.$loading.show();this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/meng001/admin/orders?page=${e}`).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,t.hide()})).catch((e=>{alert(e.response.data.message),t.hide()}))},updateOrderPaid(e){this.tempOrder={...e},this.tempOrder.is_paid=!e.is_paid,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/meng001/admin/order/${this.tempOrder.id}`,{data:this.tempOrder}).then((e=>{this.$httpMessageState({style:"success",title:"訂單更新",content:e.data.message}),this.getOrders()})).catch((e=>{this.$httpMessageState({style:"danger",title:"訂單更新",content:e.response.data.message})}))},openOrderModal(e){this.tempOrder={...e},this.tempOrder.create_at=this.changeDate(e.create_at);const t=this.$refs.orderModal;t.openModal()},changeDate(e){return new Date(1e3*e).toLocaleDateString()},openDeleteModal(e,t){e?this.isDeleteAll=!0:(this.isDeleteAll=!1,this.tempOrder={...t},this.tempOrder.create_at=this.changeDate(t.create_at));const s=this.$refs.deleteModal;s.openModal()},deleteOrder(){let e=`https://vue3-course-api.hexschool.io/v2/api/meng001/admin/order/${this.tempOrder.id}`;this.isDeleteAll&&(e="https://vue3-course-api.hexschool.io/v2/api/meng001/admin/orders/all"),this.$http.delete(e).then((e=>{this.getOrders();const t=this.$refs.deleteModal;t.closeModal(),this.$httpMessageState({style:"success",title:"訂單刪除",content:e.data.message})})).catch((e=>{this.$httpMessageState({style:"danger",title:"訂單刪除",content:e.response.data.message})}))}},mounted(){this.getOrders()}};const pe=(0,ie.Z)(ue,[["render",O]]);var he=pe}}]);
//# sourceMappingURL=127.b4ade00f.js.map